---
import { Image } from "astro:assets";
import BaseLayout from "./BaseLayout.astro";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";

interface Props {
  title: string;
  description?: string;
  pubDate?: Date;
  heroImage?: any; // Can be ImageMetadata or string
}

const { title, description, pubDate, heroImage } = Astro.props;
const isLocalImage = heroImage && typeof heroImage !== "string";
---

<BaseLayout title={title} description={description}>
  <Header />
  <main class="w-full max-w-[768px] mx-auto pb-12">
    <article class="article" data-pagefind-body>
      {
        heroImage &&
          (isLocalImage ? (
            <Image
              src={heroImage}
              alt={title}
              class="w-full h-auto rounded-xl mb-8 object-cover aspect-video"
              widths={[400, 768, 1024]}
              sizes="(max-width: 768px) 100vw, 768px"
            />
          ) : (
            <img
              src={heroImage}
              alt={title}
              class="w-full h-auto rounded-xl mb-8 object-cover aspect-video"
            />
          ))
      }
      <div class="mb-8">
        <h1
          class="text-4xl md:text-5xl font-bold tracking-tight mb-4 text-gray-900 leading-tight"
          data-pagefind-meta="title"
        >
          {title}
        </h1>
        {
          pubDate && (
            <time datetime={pubDate.toISOString()} class="text-gray-500">
              {pubDate.toLocaleDateString("en-us", {
                year: "numeric",
                month: "long",
                day: "numeric",
              })}
            </time>
          )
        }
      </div>
      <slot />
    </article>
  </main>
  <Footer />
</BaseLayout>

<style is:global>
  /* Custom typography overrides to match the design exactly if Tailwind Typography isn't enough */
  .prose p {
    margin-bottom: 1.5em;
    line-height: 1.8;
    color: #374151; /* gray-700 */
  }
</style>
